<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="keywords" content="computer, architecture">
<meta name="author" content="Cándido Aramburu">
<title>Estructura de Computadores  (240306)</title>
<style>
@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";
@import "https://cdn.jsdelivr.net/gh/asciidoctor/asciidoctor@2.0/data/stylesheets/asciidoctor-default.css";



h1, h2, h3, h4, h5, h6, #toctitle,
.sidebarblock > .content > .title {
  color: rgba(221, 72, 20, 0.8);
}



</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!-- Change some CSS.
<style>
.imageblock{
  &.text-center > .title {
    text-align: center !important;
  }
}
</style>

-->

<style type="text/css"> .imageblock > .title { text-align: center; } </style>

<style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
</head>
<body id="_pila" class="book">
<div id="header">
<h1>Estructura de Computadores  (240306)</h1>
<div class="details">
<span id="author" class="author">Cándido Aramburu</span><br>
<span id="email" class="email"><a href="mailto:candido@unavarra.es">candido@unavarra.es</a></span><br>
<span id="revdate">2022-12-14</span>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root"><a href="eecc_book.html">Estructura de Computadores  (240306)</a></span></p><ul class="sectlevel0">
<li><a href="_i_arquitectura_del_repertorio_de_instrucciones_isa_computadora_von_neumann_datos_instrucciones_programación.html">I Arquitectura del Repertorio de Instrucciones (ISA): computadora von Neumann, datos, instrucciones, programación.</a>
</li>
<li><a href="_ii_unidades_básicas_procesador_central_unidad_de_memoria_mecanismos_entradasalida.html">II Unidades Básicas: Procesador Central, Unidad de Memoria, Mecanismos Entrada/Salida.</a>
</li>
<li><a href="_iii_ejercicios_de_teoría.html">III Ejercicios de Teoría</a>
</li>
<li><a href="_iv_autoevaluación_teoría.html">IV Autoevaluación Teoría</a>
</li>
<li><a href="_v_guiones_de_prácticas_programación_ensamblador_x86.html">V Guiones de Prácticas: Programación Ensamblador x86</a>
</li>
<li><a href="_vi_hojas_de_referencia_rápida.html">VI Hojas de Referencia Rápida</a>
</li>
<li><a href="_vii_autoevaluación_prácticas.html">VII Autoevaluación Prácticas</a>
</li>
<li><a href="_viii_apéndices.html">VIII Apéndices</a>
<ul class="sectlevel1">
<li><a href="_arquitectura_de_una_computadora.html">21. Arquitectura de una Computadora</a>
</li>
<li><a href="_rtl_register_transfer_language.html">22. RTL Register Transfer Language</a>
</li>
<li><a href="_programas_ensamblador_iassim.html">23. Programas ensamblador IASSim</a>
</li>
<li><a href="_simulador_iassim_2.html">24. Simulador IASSim</a>
</li>
<li><a href="_lenguajes_de_programación_de_alto_y_bajo_nivel.html">25. Lenguajes de programación de Alto y Bajo Nivel</a>
</li>
<li><a href="_lenguajes_de_programación_en_ensamblador.html">26. Lenguajes de programación en Ensamblador</a>
</li>
<li><a href="_toolchain_cadena_de_herramientas_en_el_proceso_de_compilación.html">27. Toolchain: Cadena de Herramientas en el proceso de compilación</a>
</li>
<li><a href="_practicando_la_programación_desde_el_principio.html">28. Practicando la Programación desde el Principio</a>
</li>
<li><a href="_llamadas_al_sistema_operativo_2.html">29. Llamadas al Sistema Operativo</a>
</li>
<li><a href="_pila.html"><span class="toc-current">30. Pila</span></a>
<ul class="sectlevel2">
<li><a href="_pila.html#pila">30.1. Concepto</a>
</li>
<li><a href="_pila.html#_anchura">30.2. Anchura</a>
</li>
<li><a href="_pila.html#_frame_frame_pointer_y_stack_pointer">30.3. Frame: frame pointer y stack pointer</a>
</li>
<li><a href="_pila.html#_instrucciones_ensamblador_push_pop">30.4. Instrucciones Ensamblador Push-Pop</a>
<ul class="sectlevel3">
<li><a href="_pila.html#_anidamiento_de_llamadas">30.4.1. Anidamiento de llamadas</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="_programas_en_lenguaje_ensamblador_propuestas.html">31. Programas en Lenguaje Ensamblador: Propuestas</a>
</li>
<li><a href="_apéndice_unidad_cpu.html">32. Apéndice: Unidad CPU</a>
</li>
<li><a href="_apéndice_unidad_de_memoria_dram.html">33. Apéndice: Unidad de Memoria DRAM</a>
</li>
<li><a href="_apéndice_memoria_virtual.html">34. Apéndice: Memoria Virtual</a>
</li>
<li><a href="_lenguaje_de_programación_c_2.html">35. Lenguaje de Programación C</a>
</li>
<li><a href="_fpu_x87.html">36. FPU x87</a>
</li>
<li><a href="_estructura_de_computadores_2022_primer_parcial_teoría.html">37. Estructura de Computadores 2022: Primer Parcial Teoría</a>
</li>
<li><a href="_estructura_de_computadores_2022_primer_parcial_prácticas.html">38. Estructura de Computadores 2022: Primer Parcial Prácticas</a>
</li>
<li><a href="_estructura_de_computadores_2022_segundo_parcial_prácticas.html">39. Estructura de Computadores 2022: Segundo Parcial Prácticas</a>
</li>
<li><a href="_nominación_de_los_ficheros_del_examen.html">40. Nominación de los ficheros del examen</a>
</li>
<li><a href="_exámenes_de_cursos_anteriores.html">41. Exámenes de Cursos Anteriores</a>
</li>
<li><a href="_miaulario_videoconferencia.html">42. Miaulario: Videoconferencia</a>
</li>
</ul>
</li>
<li><a href="_ix_bibliografía.html">IX Bibliografía</a>
</li>
<li><a href="_x_glosario.html">X Glosario</a>
</li>
<li><a href="_xi_colofón.html">XI Colofón</a>
</li>
<li><a href="_index.html">Index</a>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_pila">30. Pila</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="pila">30.1. Concepto</h3>
<div class="ulist">
<ul>
<li>
<p>Stack ó Pila:</p>
<div class="ulist">
<ul>
<li>
<p>Estructura de Datos Last Input First Output (LIFO)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Memoria Externa</p>
</li>
<li>
<p>Dirección de apilamiento: En sentido de direcciones de memoria DECRECIENTE.</p>
</li>
<li>
<p>Un programa está estructurado en segmentos: Segmento datos, Segmento instrucciones, Segmento pila, &#8230;&#8203;</p>
<div class="ulist">
<ul>
<li>
<p>Memoria Principal Segmentada:</p>
<div class="imageblock kroki">
<div class="content">
<img src="https://kroki.io/ditaa/svg/eNrjUjCoMIACbV0Y0OZSQIAahWQnn1AwC1UYzkIWxmkIVtU1CsGp6bmpeSX5aMIuiSX5xfS10jOvuKSoNFmPjlYGZOYk0ipgCUeaQYUbFOAw20bXxKmyJLVYV9eOCwDHp2Oa" alt="Diagram">
</div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_anchura">30.2. Anchura</h3>
<div class="ulist">
<ul>
<li>
<p>Anchura de la pila &#8594; Word Size :</p>
<div class="ulist">
<ul>
<li>
<p>En el caso de x86-64 : anchura de 64 bits</p>
</li>
<li>
<p>En la arquitectura i386 son 32 bits</p>
</li>
</ul>
</div>
</li>
<li>
<p>Alineamiento de memoria de pila&#8594; múltiplos del word size</p>
<div class="ulist">
<ul>
<li>
<p>En el caso de x86-64 : múltiplos de 8 bytes (64 bits) &#8594; Direcciones en hexadecimal finalizadas en 0 y en 8.</p>
</li>
<li>
<p>Si el dato a apilar es menor que la anchura de la pila será necesario extenderlo. El tipo de extensión dependerá del tipo de dato (entero con signo, etc)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Segmento Pila de la arquitectura i386:</p>
<div class="imageblock kroki">
<div class="content">
<img src="https://kroki.io/ditaa/svg/eNrjUjCoMIACbV0Y0OZSQIAahWQnn1AwC1UYzkIWRjHEoMIRajZQdbKLiwtxqk1Aqp2cnIhTbUGSameQaktLS6JUGxqQpNqEJNUWxKl2gqh2xhHexMSOQYUbFOCIYhtdE6fKktRiXV07Li4A_KBgdQ==" alt="Diagram">
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_frame_frame_pointer_y_stack_pointer">30.3. Frame: frame pointer y stack pointer</h3>
<div class="ulist">
<ul>
<li>
<p>Frame: Partición de la sección pila</p>
<div class="ulist">
<ul>
<li>
<p>Cada función que es llamada genera un frame</p>
</li>
<li>
<p>Los límites del <strong>frame activo</strong>  se señalan con dos punteros:</p>
<div class="ulist">
<ul>
<li>
<p>límite inferior: frame pointer, señala la ubicación del <em>primer</em> elemente apilado.</p>
</li>
<li>
<p>límite superior: stack pointer, señala la ubicación del <em>último</em> elemento apilado.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Stack Pointer (<strong>sp</strong>)</p>
<div class="ulist">
<ul>
<li>
<p>Puntero que apunta al elemento TOP del frame: límite alto de la pila  donde se ubica el último elemento apilado.</p>
</li>
<li>
<p>En intel x86 es el registro RSP</p>
</li>
</ul>
</div>
</li>
<li>
<p>Frame pointer (<strong>fp</strong>)</p>
<div class="ulist">
<ul>
<li>
<p>Puntero que apunta al elemento BOTTOM del frame : límite bajo de la pila  donde se ubica el primer elemento apilado.</p>
</li>
<li>
<p>En intel x86 es el registro RBP</p>
</li>
</ul>
</div>
</li>
<li>
<p>Sección de Pila (partición en Frames)</p>
<div class="imageblock kroki">
<div class="content">
<img src="https://kroki.io/ditaa/svg/eNrVlsGOgjAQQM_yFXPENJNwJSEmNI2ndQ8mxrOCJB5UQt2Ew378FoWItVOpIrpzgfRRmjczpUCcpsVGSgBARDGPZ-qCHgRlUAfDJph6iAbuyINL_Bru7KAraq_CqBmMflU3dO2S8K-F0YUAXdEbMqZX8tad0WmxoarH4rop1OKJEOKfubQ7WblMTxFWLpzzHlxkjpPh6pIX2_0xA31X9uSiowiz_Gkfag5VG1H5hGH4sE-EMn9Vn8mf3ex4-LYivTYOLpnWTE_vmU7Jt9bF0YVOfh_7f7fa7s0b40ys6J6LQ_I_oC5ByS_f5QHOmMfOy4bZ0FDnZVBO67j5WyKAO2q7RIjLQ5Gq4Uk1PGrG_dUYDOGvjcMnlJAI_HTs_QF-DKSM" alt="Diagram">
</div>
</div>
</li>
<li>
<p>(a) La pila no esta formada</p>
</li>
<li>
<p>(b) llamada a main: se forma el frame de main. El frame crece y decrece según apilamos y extraemos</p>
</li>
<li>
<p>(c) llamada de main a sumMtoN: el frame sumMtoN se forma sobre el anterior de main: nuevos punteros FP y SP.</p>
</li>
<li>
<p>(d) llamada de sumMtoN a printf: el frame printf se forma sobre el anterior de sumMtoN: nuevos punteros FP y SP.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
La pila es una estructura dinámica que se genera en el momento de la llamada de una función y desaparece con el retorno de la función
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_instrucciones_ensamblador_push_pop">30.4. Instrucciones Ensamblador Push-Pop</h3>
<div class="ulist">
<ul>
<li>
<p>Instrucción Push-Pop : Apilamiento-Extracción</p>
<div class="ulist">
<ul>
<li>
<p>Push Op_source</p>
<div class="ulist">
<ul>
<li>
<p>Operación: insertar dato.</p>
</li>
<li>
<p>Operando destino: la pila.</p>
</li>
<li>
<p>El stack pointer se DECREMENTA en una palabra . SP &#8592; SP-1*WordSize y después se inserta el operando fuente en el destino.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Pop Op_dest</p>
<div class="ulist">
<ul>
<li>
<p>Operación: extraer dato.</p>
</li>
<li>
<p>Operando fuente: El último objeto apilado.</p>
</li>
<li>
<p>Primero se extrae el objeto referenciado por el stack pointer. A continuación el stack pointer se INCREMENTA en una palabra. SP &#8592; SP+1*WordSize</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock kroki">
<div class="content">
<img src="https://kroki.io/ditaa/svg/eNrtlj0PgjAQhmf5FTdCyCWsJMSEpnHSxcQ4K-gqkcXBH2-LqAV6cqCCJt5Cc2_p9en14yBO0-MuzwEAEeUyXqgPOhCcZqX5eDNfdaKF7pIDDztbWs8FrmRG8ak_fHoonlRlScR8ZWUhBK40worVM9kqcCW9xwIRFKaCJ1LKyjT2GU7NWUWYZ4RkBKhLA7LE1w2uWYQQffNiYPbLi6XVkaUS_BWWFsyXeVioOjdlaqTmCcNwtDNzP8kWFo5Uz82oLL3y8mj9Wb6V5X5ewmHemN-Pom7_0hrVEiF0l0yWCHF9OKbKPdXuyc3vbjywmLu1ugspISVwU89xGLUbteJUfURVNPQ4zbjP3nlgzLP-_kB_Nm5_6y3-xvE_25_nb92514218y6iK_bP" alt="Diagram">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>(a) La pila no esta formada</p>
</li>
<li>
<p>(b) Se forma la pila inicializando los punteros de pila: frame pointer (fp) y stack pointer (sp)</p>
</li>
<li>
<p>(c) Ejecución de push</p>
</li>
<li>
<p>(d) Ejecución de push</p>
</li>
<li>
<p>(e) Ejecución de pop</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_anidamiento_de_llamadas">30.4.1. Anidamiento de llamadas</h4>
<div class="ulist">
<ul>
<li>
<p>TODO</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>← Previous: <a href="_llamadas_al_sistema_operativo_2.html">Llamadas al Sistema Operativo</a> | ↑ Up: <a href="_viii_apéndices.html">VIII Apéndices</a> | ⌂ Home: <a href="eecc_book.html">Estructura de Computadores  (240306)</a> | Next: <a href="_programas_en_lenguaje_ensamblador_propuestas.html">Programas en Lenguaje Ensamblador: Propuestas</a> →</p>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-11-03 13:10:16 +0100
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>